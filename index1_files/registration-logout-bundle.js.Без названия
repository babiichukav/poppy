(window.webpackJsonp_spotim_registration=window.webpackJsonp_spotim_registration||[]).push([[32],{27:function(t,e,r){"use strict";r.d(e,"f",(function(){return c})),r.d(e,"g",(function(){return a})),r.d(e,"e",(function(){return u})),r.d(e,"h",(function(){return i})),r.d(e,"d",(function(){return s})),r.d(e,"c",(function(){return f})),r.d(e,"b",(function(){return d})),r.d(e,"a",(function(){return p}));var n=r(47),o=r.n(n);function c(){return document.body.clientWidth<480}var a=c(),u="object"===("undefined"==typeof window?"undefined":o()(window))&&/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),i=function(t){return t.replace(/-./g,(function(t){return t.toUpperCase()[1]}))};function s(t){switch(t){case"fields.email.errors.invalid":return 1;default:return}}var f=function(t){return btoa(unescape(encodeURIComponent(t)))},d=function(t){return decodeURIComponent(escape(window.atob(t)))},p=function(t){return t?t.charAt(0).toUpperCase()+t.slice(1):""}},29:function(t,e,r){"use strict";r.r(e);var n=r(22),o=r.n(n),c=r(23),a=r.n(c),u=r(12),i=r(16),s=r.n(i),f=r(2),d=r(25),p=r(1),l=r(3),O=r(27),g=function(){var t=a()(o.a.mark((function t(e){var r,n,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!p.j&&!p.m){t.next=7;break}return t.next=4,s()("v1.0.0/authentication/current-user",{method:"POST",headers:{"x-spot-id":p.t,"x-real-user-mode":"true"}});case 4:r=t.sent,t.next=10;break;case 7:return t.next=9,Object(d.default)("me/login",{method:"POST",body:JSON.stringify({spot_id:p.t})});case 9:r=t.sent;case 10:return(n=Object(u.parseUser)(r)).isRegistered&&(Object(f.dispatchSpotimEvent)("spot-im-post-login",{currentUser:{email:n.email||"",username:n.username||""}}),e&&(c=Object(O.c)(JSON.stringify({userId:n.id,displayName:n.displayName,imageId:n.imageId,social:e})),localStorage.setItem(p.a,c))),t.abrupt("return",n);case 15:throw t.prev=15,t.t0=t.catch(0),l.a.error("login",t.t0),new Error("Login failed due to with error: ".concat(t.t0));case 19:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}();e.default=g},30:function(t,e,r){"use strict";r.d(e,"a",(function(){return f}));var n=r(22),o=r.n(n),c=r(23),a=r.n(c),u=r(12),i=r.n(u),s=r(1),f=function(){var t=a()(o.a.mark((function t(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){return setTimeout((function(){i.a.set(e),t()}),s.r)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},33:function(t,e,r){"use strict";var n=r(22),o=r.n(n),c=r(23),a=r.n(c),u=r(12),i=r.n(u),s=r(25),f=r(1);e.a=a()(o.a.mark((function t(){var e,r,n,c,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.getAsyncToken();case 2:return e=t.sent,r=e.networkId,t.next=6,Object(s.default)("me/network-token/".concat(r),{method:"POST",body:JSON.stringify({spot_id:f.t})});case 6:return n=t.sent,c=n.network_id,a=n.token,i.a.setToken(a,c),t.abrupt("return",{token:a});case 11:case"end":return t.stop()}}),t)})))},34:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r(2),o=null;function c(t){for(var e,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];(e=console).log.apply(e,["%cSpot.IM ".concat(t),"background: #307fe2; color: white;"].concat(n))}function a(t){var e=function(){try{if(null===o){var t=new URLSearchParams(Object(n.getLocation)().search);if((o=t.get("SPOTIM_DEBUG_API".toLowerCase()))||(o=window.SPOTIM_DEBUG_API),!o)try{o=window.localStorage.getItem("SPOTIM_DEBUG_API")}catch(t){}o||(o=""),o=o.split(",").map((function(t){return t.toLowerCase()}))}return o}catch(t){return[]}}();return e.indexOf("*")>-1||e.indexOf(t.toLowerCase())>-1?c.bind(null,t):function(){}}},39:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"c",(function(){return u})),r.d(e,"b",(function(){return i}));var n=r(3),o=r(34),c=Object(o.a)("SSO"),a=function(t){var e;try{e=localStorage.getItem("OWֹֹ_EXTERNAL_USER_ID")||""}catch(t){var r="SSO - cannot get ".concat("OWֹֹ_EXTERNAL_USER_ID"," from local storage: ").concat(t);c(r),n.a.error("startSSO",r)}return String(t)!==String(e)},u=function(t){try{localStorage.setItem("OWֹֹ_EXTERNAL_USER_ID",t)}catch(t){var e="SSO - cannot set ".concat("OWֹֹ_EXTERNAL_USER_ID"," in local storage: ").concat(t);c(e),n.a.error("startSSO",e)}},i=function(){try{localStorage.removeItem("OWֹֹ_EXTERNAL_USER_ID")}catch(e){var t="SSO - cannot set ".concat("OWֹֹ_EXTERNAL_USER_ID"," in local storage: ").concat(e);c(t),n.a.error("startSSO",t)}}},62:function(t,e,r){"use strict";r.r(e);var n=r(22),o=r.n(n),c=r(5),a=r.n(c),u=r(23),i=r.n(u),s=r(12),f=r.n(s),d=r(16),p=r.n(d),l=r(25),O=r(17),g=r(1),b=r(3),m=r(30),w=r(33),S=r(29),v=r(39),h=r(34);function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){a()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var j=Object(h.a)("Registration"),E=function(){var t=i()(o.a.mark((function t(){var e,r,n,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,j("Logout started"),t.next=4,f.a.getAsyncUser();case 4:if(e=t.sent,e.isRegistered){t.next=8;break}return t.abrupt("return",e);case 8:if(!g.j){t.next=15;break}return t.next=11,p()("v1.0.0/authentication/logout",{method:"POST",headers:{"x-spot-id":g.t}});case 11:r=t.sent,e=Object(s.parseUser)(r),t.next=25;break;case 15:return t.next=17,Object(l.default)("me/logout",{method:"POST",body:JSON.stringify({spot_id:g.t})});case 17:return t.next=19,Object(w.a)();case 19:return n=t.sent,c=n.token,f.a.setToken(c),t.next=24,Object(S.default)();case 24:e=t.sent;case 25:return Object(v.b)(),t.next=28,Object(m.a)(_(_({},e),{},{isSuperAdmin:!1}));case 28:return j("Logout succeed, new current user is: ",e),Object(O.trackEvent)({source:"conversation",spot_id:g.t,post_id:g.o,type:"logout-clicked",item_type:"logout",segment:"success"}),t.abrupt("return",e);case 33:return t.prev=33,t.t0=t.catch(0),b.a.error("logout",t.t0),j("Logout failed with: ",t.t0),Object(O.trackEvent)({source:"conversation",spot_id:g.t,post_id:g.o,type:"logout-clicked",item_type:"logout",segment:"error"}),t.abrupt("return",new Error("Logout failed due to with error: ".concat(t.t0)));case 39:case"end":return t.stop()}}),t,null,[[0,33]])})));return function(){return t.apply(this,arguments)}}();e.default=E}}]);
//# sourceMappingURL=registration-logout-bundle.js.map